function e(e){return e&&e.__esModule?e.default:e}var t,n,o=globalThis,s={},i={},r=o.parcelRequirec6a0;null==r&&((r=function(e){if(e in s)return s[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return s[e]=n,t.call(n.exports,n,n.exports),n.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){i[e]=t},o.parcelRequirec6a0=r),(0,r.register)("awTFk",function(e,t){Object.defineProperty(e.exports,"register",{get:()=>n,set:e=>n=e,enumerable:!0,configurable:!0});var n,o=new Map;n=function(e,t){for(var n=0;n<t.length-1;n+=2)o.set(t[n],{baseUrl:e,path:t[n+1]})}}),r("awTFk").register(new URL("",import.meta.url).toString(),JSON.parse('["fzFkW","index.bbfd1f94.js","9ubBU","sw.js"]'));const l=Math.PI,a=1/3.2808399,d=1/1.852,c={UInt8:(e,t)=>e.getUint8(t,!1),UInt16LE:(e,t)=>e.getUint16(t,!0),UInt32LE:(e,t)=>e.getUint32(t,!0),FloatLE:(e,t)=>e.getFloat32(t,!0)};let u={blockSize:{offset:26,type:"UInt16LE",len:2},lastBlockSize:{offset:28,type:"UInt16LE",len:2},channel:{offset:30,type:"UInt16LE",len:2},packetSize:{offset:32,type:"UInt16LE",len:2},frameIndex:{offset:34,type:"UInt32LE",len:4},upperLimit:{offset:38,type:"FloatLE",len:4},lowerLimit:{offset:42,type:"FloatLE",len:4},frequency:{offset:51,type:"UInt8",len:1},time1:{offset:58,type:"UInt16LE",len:4},waterDepthFt:{offset:62,type:"FloatLE",len:4},keelDepthFt:{offset:66,type:"FloatLE",len:4},speedGpsKnots:{offset:98,type:"FloatLE",len:4},temperature:{offset:102,type:"FloatLE",len:4},raw_lowrance_longitude:{offset:106,type:"UInt32LE",len:4},raw_lowrance_latitude:{offset:110,type:"UInt32LE",len:4},speedWaterKnots:{offset:114,type:"FloatLE",len:4},courseOverGround:{offset:118,type:"FloatLE",len:4},altitudeFt:{offset:122,type:"FloatLE",len:4},heading:{offset:126,type:"FloatLE",len:4},flags:{offset:130,type:"UInt16LE",len:2},time:{offset:138,type:"UInt32LE",len:4}};async function p(e,t){let n,o=0,s=[];n=10;let i=new DataView(e,0),r=i.byteLength;console.log(r,n);for(var p=null,m=null;n<r;){if(o%500==0){var h=100*n/r;await t(Math.round(h))}o+=1;let e=function(e,t){let n={};for(let o in u)if(Object.hasOwnProperty.call(u,o)){let s=t+u[o].offset;u[o].len;let i=c[u[o].type];n[o]=i(e,s)}return n}(i,n);if(void 0!=e.raw_lowrance_latitude&&(e.latitude=(2*Math.atan(Math.exp(e.raw_lowrance_latitude/6356752.3142))-l/2)*(180/l),null==p&&(p=e.raw_lowrance_latitude),e.y_displacement=e.raw_lowrance_latitude-p),void 0!=e.raw_lowrance_longitude&&(e.longitude=e.raw_lowrance_longitude/6356752.3142*(180/l),e.longitude>180&&(e.longitude=(e.raw_lowrance_longitude-4294967295)/6356752.3142*(180/l)),null==m&&(m=e.raw_lowrance_longitude),e.x_displacement=e.raw_lowrance_longitude-m),void 0!=e.waterDepthFt&&(e.waterDepthFt*=-1,e.waterDepthM=e.waterDepthFt*a),void 0!=e.keelDepthFt&&(e.keelDepthFt*=-1,e.keelDepthM=e.keelDepthFt*a),void 0!=e.altitudeFt&&(e.altitudeM=e.altitudeFt*a),void 0!=e.speedGpsKnots&&(e.speedGpsKm=e.speedGpsKnots*d),0==e.blockSize){alert("ABORTING! (sl2 file may be corrupt): blockSize = 0 found which will otherwise lead to endless loop.");break}n+=e.blockSize,s.push(e)}return console.log("Found and decoded "+s.length+"data blocks."),s}var m={};t=function(){return function e(t,n,o){var s,i,r=window,l="application/octet-stream",a=o||l,d=t,c=!n&&!o&&d,u=document.createElement("a"),p=function(e){return String(e)},m=r.Blob||r.MozBlob||r.WebKitBlob||p,h=n||"download";if(m=m.call?m.bind(r):Blob,"true"===String(this)&&(a=(d=[d,a])[0],d=d[1]),c&&c.length<2048&&(h=c.split("/").pop().split("?")[0],u.href=c,-1!==u.href.indexOf(c))){var f=new XMLHttpRequest;return f.open("GET",c,!0),f.responseType="blob",f.onload=function(t){e(t.target.response,h,l)},setTimeout(function(){f.send()},0),f}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(d)){if(!(d.length>2096103.424&&m!==p))return navigator.msSaveBlob?navigator.msSaveBlob(w(d),h):_(d);a=(d=w(d)).type||l}else if(/([\x80-\xff])/.test(d)){for(var g=0,v=new Uint8Array(d.length),y=v.length;g<y;++g)v[g]=d.charCodeAt(g);d=new m([v],{type:a})}function w(e){for(var t=e.split(/[:;,]/),n=t[1],o=("base64"==t[e.indexOf("charset")>0?3:2]?atob:decodeURIComponent)(t.pop()),s=o.length,i=0,r=new Uint8Array(s);i<s;++i)r[i]=o.charCodeAt(i);return new m([r],{type:n})}function _(e,t){if("download"in u)return u.href=e,u.setAttribute("download",h),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",u.addEventListener("click",function(e){e.stopPropagation(),this.removeEventListener("click",arguments.callee)}),document.body.appendChild(u),setTimeout(function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout(function(){r.URL.revokeObjectURL(u.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,l)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,l)),n.src=e,setTimeout(function(){document.body.removeChild(n)},333)}if(s=d instanceof m?d:new m([d],{type:a}),navigator.msSaveBlob)return navigator.msSaveBlob(s,h);if(r.URL)_(r.URL.createObjectURL(s),!0);else{if("string"==typeof s||s.constructor===p)try{return _("data:"+a+";base64,"+r.btoa(s))}catch(e){return _("data:"+a+","+encodeURIComponent(s))}(i=new FileReader).onload=function(e){_(this.result)},i.readAsDataURL(s)}return!0}},"function"==typeof define&&define.amd?define([],t):m=t();const h=document;class f{constructor(e,t={},n={}){this.options=Object.assign({},n,t),this._events=[],this.dom={el:this._setElement(e)}}toggle(e){let t=this.dom.el.classList;return void 0!==e?t[e?"remove":"add"]("si-off"):t.toggle("si-off"),this}on(e,t,n=null){return(n||this.dom.el).addEventListener(e,t=t.bind(this),!0),this._events.push({name:e,fn:t,el:n}),this}getElement(){return this.dom.el}remove(){this._events=this._events.filter(e=>(e.el||this.dom.el).removeEventListener(e.name,e.fn,!0)),this.dom.el.parentNode.removeChild(this.dom.el),this.dom=this.options=null}_setElement(e){if(!e&&!e.nodeType&&"string"!=typeof e)throw Error("Wrong element type provided!");return e.nodeType?e:(this.options.parent||h).querySelector(e)}_trigger(e,t=null){let n;"function"==typeof CustomEvent?n=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}):(n=h.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,t),this.dom.el.dispatchEvent(n)}}var g={items:[],display:"value",current:null,parent:null,maxHeight:0,sort:!0,order:"desc",placeholder:"Select items",more:"(+{X} more)"};const v=document;class y extends f{constructor(e,t={}){super(e,t,g),this.options.sort&&(this.options.items=this._sortItems(t.items)),this.options.items=t.items&&t.items.length?this._convertItems(t.items):[],t.current&&t.current.length&&(t.current=this._convertItems(t.current),this._setSelected(t.current)),this._renderInit(),this._setResultMessage(),this._bindEvents()}_bindEvents(){this.on("click",e=>{if(e.target.classList.contains("si-item"))return this._setCurrent(e)._setResultMessage();this.toggle()},this.el),this.on("click",e=>{if(!this.dom.el.contains(e.target))return this.toggle(!1)},v),this.on("keyup",e=>{("Escape"===e.key||27===e.keyCode)&&this.toggle(!1)},v)}getItems(){return Array.from(this.options.items.values())}getCurrent(e=""){let t=this.getItems().filter(e=>e.selected);return e?t.map(t=>t[e]):t}setCurrent(e){let t=Array.isArray(e);if(!e||t&&!e.length)return;let n=this.options.items,o=this.options.display;e=t?e:[e],(e=this._convertItems(e)).forEach(e=>{n.forEach((t,n)=>{t[o]===e[o]&&(this.dom.el.querySelector(`.si-item[data-key="${n}"]`).classList.add("si-selected"),t.selected=!0)})}),this._setResultMessage()}findItem(e){let t=this.options.display;return e=e.nodeName?e.dataset.value:e,this.options.items.find(n=>n[t]===e)}_setCurrent(e,t=!0){let n=e.target,o=parseInt(n.dataset.key,10),s=this.options.items.get(o);return s.selected=n.classList.toggle("si-selected"),this.options.items.set(o,s),t&&this._trigger("change",s),this}_setSelected(e){let t=this.options.items,n=this.options.display;e.forEach(e=>{t.forEach(t=>{t[n]===e[n]&&(t.selected=!0)})})}_setResultMessage(){let e=this.getCurrent(),t=this.options.display,n=e.length,o="";switch(n){case 1:o=e[0][t];break;case 0:o=this.options.placeholder;break;default:o=/({X})/.test(this.options.more)?`${e[0][t]} ${this.options.more.replace("{X}",n-1)}`:this.options.more}this.dom.result.classList[n?"add":"remove"]("si-selection"),this.dom.result.innerHTML=o}_convertItems(e=[]){let t=this.options.display,n=new Map,o=0;return e.forEach(e=>{"object"!=typeof e&&(e={[t]:e}),n.set(o++,e)}),n}_renderInit(){let e=v.createDocumentFragment();return this.dom.el.classList.add("si-off","si-wrap"),this.dom.result=e.appendChild(this._renderResultDiv()),e.appendChild(this._renderList()),this.dom.el.appendChild(e)}_renderResultDiv(){let e=v.createElement("div");return e.className="si-result",e}_renderList(){let e=v.createElement("div"),t=v.createElement("ul"),n=this.options.maxHeight;return e.className="si-list",n&&(e.style.maxHeight=n+"px"),t.innerHTML=this._renderListItems(),e.appendChild(t),e}_renderListItems(){let e=this.options.items,t=this.options.display,n="",o;return e.forEach((e,s)=>{o=e.selected?" si-selected":"",n+=`<li class="si-item${o}" data-key="${s}">${e[t]}</li>`}),n}_sortItems(){let e="desc"===this.options.order?1:-1,t=this.options.display;this.options.items.sort((n,o)=>n[t]<o[t]?-e:n[t]>o[t]?e:0)}}var w={};function _(){return -1!=navigator.userAgent.indexOf("Windows")?"\r\n":"\n"}function E(t){var o=t.target.files[0],s=new FileReader;s.onload=function(t){var s=t.target.result;console.log("Loaded file: ",s),document.getElementById("Info_Text").style.display="none",document.getElementById("input").disabled="true";var i=document.getElementById("message"),r=document.getElementById("progress-bar");i.innerHTML="Converting... (May make page unresponsive)",r.style.display="block",setTimeout(function(){p(s,async e=>{i.innerHTML=`Converting... ${e}% done`,r.value=e/100,await new Promise(e=>setTimeout(e,0))}).then(t=>{var s;r.style.display="none",document.getElementById("message").innerHTML="Done!",function(e){var t=[];for(var o in e[0])t.push(o);n=new y("#Column_Selector",{items:t,current:["latitude","longitude","waterDepthM"],sort:!1,placeholder:"Select columns to include"})}(t),(s=document.getElementById("download_button")).parentNode.style.display="block",s.onclick=function(){var s,i,r=document.getElementById("Output_Format").value;"csv"==r?(s=function(e,t){let n=Object.keys(e[0]).filter(e=>!0==t[e]).join(",")+_();for(var o=0;o<e.length;o++)n+=Object.keys(e[o]).filter(e=>!0==t[e]).map(t=>e[o][t].toString()).join(",")+_();return n}(t,function(){for(var e=n.getCurrent(),t={},o=0;o<e.length;o++)t[e[o].value]=!0;return t}()),e(m)(s,o.name+"_converted.csv","text/csv")):"kml"==r&&(i=function(e){let t=`<?xml version="1.0" encoding="UTF-8"?>
    <kml xmlns="http://www.opengis.net/kml/2.2">
    <Document>
      <name>SonarConverted.kml</name>
      <open>1</open>
      <Placemark>
        <name>SonarPath</name>
        <LineString>
          <extrude>1</extrude>
          <tessellate>1</tessellate>
          <altitudeMode>relativeToGround</altitudeMode>
          <coordinates>
          `;for(var n=0;n<e.length;n++)t+=["longitude","latitude","waterDepthM"].map(t=>e[n][t].toString()).join(",")+" ";return t+`
                </coordinates>
            </LineString>
        </Placemark>
    </Document>
    </kml>
    `}(t),e(m)(i,o.name+"_converted.kml","application/vnd.google-earth.kml+xml"))}}).catch(e=>{console.error("Conversion failed: ",e),r.style.display="none",i.innerHTML="Conversion failed. Please reload the page and try again."})},1)},s.readAsArrayBuffer(o)}w=new URL("sw.js",import.meta.url).toString(),"serviceWorker"in navigator&&navigator.serviceWorker.register(w).then(()=>{console.log("Service Worker Registered")}),window.addEventListener("load",function(){console.log("Page loaded"),document.getElementById("input").addEventListener("change",E,!1)});
//# sourceMappingURL=index.bbfd1f94.js.map
